import{d as F,e as M,g as r,i,j as E,k as P,o as _,l as O,b as c,q as $,p as u,n as j,c as D,F as K,D as L,w as q,M as z,s as T,z as U}from"./islands-BZEcu5Tg.js";import{u as W,_ as k,a as G}from"./useAuthConfig-Cbw7dd8t.js";import{_ as H,a as J}from"./InputLabel.vue_vue_type_script_setup_true_lang-zTz6K1Md.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./BaseLink.vue_vue_type_script_setup_true_lang-Dv09fmhI.js";const X={class:"mb-3"},Y=["onUpdate:modelValue","onInput","onKeydown"],Z={class:"d-grid mt-2"},ee=F({__name:"VerifyOtpPage",setup(ae){const a=M(),d=r(a.otpEmail||""),o=r(Array.from({length:6},()=>"")),y=r([]),h=i(()=>o.value.join(""));E(()=>a.otpEmail,e=>{e&&(d.value=e)});const f=i(()=>a.loading),x=i(()=>a.fieldErrors),p=r(!1),v=r(!1),w=i(()=>f.value||p.value),m=i(()=>f.value||v.value);W({requireEmailFlow:!0,loadAuthConfig:()=>a.loadAuthConfig()});const C=()=>{a.resetStatus()},V=e=>{if(a.fieldErrors&&a.fieldErrors[e]){const t={...a.fieldErrors};delete t[e],a.fieldErrors=Object.keys(t).length?t:null}a.error&&(a.error="")};E(h,e=>{e&&V("otp_code"),e.length===o.value.length&&!f.value&&b()});const S=(e,t)=>{const n=e;n&&(y.value[t]=n)},g=e=>{const t=y.value[e];t&&(t.focus(),t.select())},I=(e,t)=>{const s=t.target.value.replace(/\D/g,"");o.value[e]=s.slice(-1),s&&e<o.value.length-1&&g(e+1)},R=(e,t)=>{t.key==="Backspace"&&!o.value[e]&&e>0&&g(e-1)},A=e=>{const n=(e.clipboardData?.getData("text")||"").replace(/\D/g,"").slice(0,o.value.length).split("");if(!n.length)return;e.preventDefault(),o.value=o.value.map((l,N)=>n[N]||"");const s=Math.min(n.length,o.value.length-1);g(s)},b=async()=>{if(!w.value){p.value=!0;try{await a.verifyOtp({email:d.value,otp_code:h.value}),window.location.assign("/reset-password")}catch{}finally{p.value=!1}}},B=async()=>{if(!m.value){v.value=!0;try{await a.resendOtp({email:d.value})}catch{}finally{v.value=!1}}};return(e,t)=>(_(),P(G,{title:"Save N Load",subtitle:"We've sent a verification code to your email.","on-reset":C},{default:O(()=>[c("form",{onSubmit:$(b,["prevent"])},[c("div",X,[u(H,{text:"6-Digit Verification Code","label-class":"mb-2"}),c("div",{class:j(["otp-grid",{"is-invalid":!!x.value?.otp_code}])},[(_(!0),D(K,null,L(o.value,(n,s)=>q((_(),D("input",{key:s,ref_for:!0,ref:l=>S(l,s),"onUpdate:modelValue":l=>o.value[s]=l,inputmode:"numeric",maxlength:"1",class:"otp-box",type:"text",autocomplete:"one-time-code",onInput:l=>I(s,l),onKeydown:l=>R(s,l),onPaste:t[0]||(t[0]=l=>A(l))},null,40,Y)),[[z,o.value[s]]])),128))],2)]),c("div",Z,[u(J,{type:"button",variant:"secondary",class:"text-white fw-bold py-2",disabled:m.value||w.value,loading:m.value,onClick:B},{default:O(()=>[...t[1]||(t[1]=[T(" RESEND CODE ",-1)])]),_:1},8,["disabled","loading"])]),u(k,{prefix:"Remember your password? ","link-text":"Login",to:"/"}),u(k,{prefix:"Wrong email? ","link-text":"Start Over",to:"/forgot-password","text-class":"mt-2"})],32)]),_:1}))}}),te=Q(ee,[["__scopeId","data-v-3d440f6b"]]);U("verify-otp",te);
