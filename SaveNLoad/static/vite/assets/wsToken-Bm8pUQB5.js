import{R as u,S as f}from"./islands-BZEcu5Tg.js";const w="http://localhost:8000/api",d=t=>t.startsWith("/")?t:`/${t}`,m=(t,n)=>{const e=d(t),o=w,a=new URL(o,window.location.origin),i=a.protocol==="https:"?"wss:":"ws:",c=new URL(`${i}//${a.host}${e}`);return n&&Object.entries(n).forEach(([h,l])=>{l&&c.searchParams.set(h,l)}),c.toString()},k="http://localhost:8000/api";let s=null,r=null;const p=async()=>r||(s||(s=(async()=>{try{const t=await u(),n=await f(()=>fetch(`${k}/auth/ws-token/`,{method:"POST",headers:{"X-CSRFToken":t},credentials:"include"})),e=await n.json().catch(()=>null);if(!n.ok)return null;const o=e?.token||null;return o&&(r=o),o}catch{return null}finally{s=null}})()),s);export{m as b,p as g};
